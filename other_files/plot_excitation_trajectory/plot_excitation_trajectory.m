%%
dof=7;
wf=0.05*2*pi;
Tf=20;
h=0.1;
opt_x=[0.0728571, -0.00212468, -0.0579133, 0.0873986, -0.100218, -0.083701, 0.254526, 0.259813, 0.0451801, -0.277102, 0.273877, -0.0485961, 0.0925676, -0.050029, 0.216537, -0.210479, 0.035197, 0.173231, -0.313706, 0.479035, -0.271336, 0.263355, -0.165679, 0.0205654, 0.00632681, 0.088292, 0.050495, 0.149397, -0.00215241, 0.281822, -0.388133, 0.112395, 0.533828, 0.0338062, -0.0301338, 0.078393, 0.00343772, -0.0855031, 0.0886998, 0.212675, -0.117752, 0.198772, -0.191177, 0.532356, -0.191637, 0.313638, -0.206932, 0.0319599, 0.0529713, 0.125959, -0.0942058, 0.369703, 0.0107305, -0.217916, 0.513083, -0.0956188, -0.0789789, 0.21232, 0.174839, -0.212562, 0.215886, 0.0126467, -0.105617, -0.108732, 0.10212, 0.573736, 0.0212299, 0.0195743, -0.0593477, -0.0191542, 0.0376976, 0.014927, 0.100582, -0.168453, 0.0387429, 0.0268593, 0.0767911];

count=Tf/h;
opt_q=zeros(count+1,dof);
opt_dq=zeros(count+1,dof);
opt_ddq=zeros(count+1,dof);

t=-h;
for k=1:(count+1)
    t=t+h;
    [opt_q(k,:),opt_dq(k,:),opt_ddq(k,:)]=generate_fourier_trajectory(opt_x,wf,t); 
end

time=0:h:Tf;
close all;
figure;
plot(time,opt_q(:,1),time,opt_q(:,2),time,opt_q(:,3),time,opt_q(:,4),time,opt_q(:,5),time,opt_q(:,6),time,opt_q(:,7),'Linewidth',2);
grid on;
legend('$q_{1}$','$q_{2}$','$q_{3}$','$q_{4}$','$q_{5}$','$q_{6}$','$q_{7}$','Interpreter','Latex');

figure;
plot(time,opt_dq(:,1),time,opt_dq(:,2),time,opt_dq(:,3),time,opt_dq(:,4),time,opt_dq(:,5),time,opt_dq(:,6),time,opt_dq(:,7),'Linewidth',2);
grid on;
legend('$\dot{q}_{1}$','$\dot{q}_{2}$','$\dot{q}_{3}$','$\dot{q}_{4}$','$\dot{q}_{5}$','$\dot{q}_{6}$','$\dot{q}_{7}$','Interpreter','Latex');

figure;
plot(time,opt_ddq(:,1),time,opt_ddq(:,2),time,opt_ddq(:,3),time,opt_ddq(:,4),time,opt_ddq(:,5),time,opt_ddq(:,6),time,opt_ddq(:,7),'Linewidth',2);
grid on;
legend('$\ddot{q}_{1}$','$\ddot{q}_{2}$','$\ddot{q}_{3}$','$\ddot{q}_{4}$','$\ddot{q}_{5}$','$\ddot{q}_{6}$','$\ddot{q}_{7}$','Interpreter','Latex');








